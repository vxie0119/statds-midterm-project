---
title: "Midterm Project"
author: "Vincent Xie"
toc: true
number-sections: true
highlight-style: pygments
format: 
  pdf: 
    geometry: 
      - top=30mm
      - left=20mm
---

# **Midterm Project: Rodents in NYC** {.unnumbered}

[Rodents in NYC](https://en.wikipedia.org/wiki/Rats_in_New_York_City)
are widespread, as they are in many densely populated areas. As of
October 2023, NYC dropped from the 2nd to the 3rd places in the annual
["rattiest city"
list](https://www.orkin.com/press-room/top-rodent-infested-cities-2023#)
released by a pest control company. Rat sightings in NYC was analyzed
by Dr. Michael Walsh in a [2014 PeerJ
article](https://peerj.com/articles/533/). We investigate this problem
from a different angle with the [NYC Rodent Inspection
data](https://data.cityofnewyork.us/Health/Rodent-Inspection/p937-wjvj/about_data),
provided by the Department of Health and Mental Hygiene (DOHMH).
Download the 2022-2023 data by filtering the `INSPECTION_DATE` to
between 11:59:59 pm of 12/31/2021 and 12:00:00 am of 01/01/2024
and `INSPECTION_TYPE` is either `Initial` or `Compliance` (which
should be about 108 MB). Read the meta data information
to understand the data.

## Data Initialization
```{python}
# Importing packages and dataset
import pandas as pd

data = pd.read_csv("./Rodent_Inspection_Data.csv")

# Listing the columns in vertical order
columns = data.columns.to_series().reset_index(drop=True)
columns

```

## Data cleaning.
+ There are two zipcode columns: `ZIP_CODE` and `Zipcodes`.
  Which one represent the zipcode of the inspection site? 
  Comment on the data dictionary.

The column `ZIP_CODE` represents the actual zipcode of the inspection site. When reviewing some of the `Zipcodes` values, I saw that some of them were from different states. Based on the data dictionary, I did not see `Zipcodes` in that file. 

+ Summarize the missing information. Are their missing values
  that can be filled using other columns? Fill in those values.

+ Are their redundant information in the data? Try storing
  the data using `arrow` and comment on the efficiency gain.

+ Are there invalid zipcode or borough? Justify and clean
  them up if yes.

## Data exploration.

+ Create binary variable `passing` indicating passing or
  not for the inspection result. Does `passing` depend on
  whether the inspection is initial or compliance? State
  your hypothesis and summarize your test result.

+ Are the passing pattern different across different
  boroughs for initial inspections? How about compliance
  inspections? State your hypothesis and summarize your
  test results.

+ If we suspect that the passing rate may depends on
  the time of a day of the inspection, we may compare
  the passting rates for inspections done in the mornings
  and inspections one in the afternoons. Visualize the
  comparison by borough and inspection type.

+ Perform a formal hypothesis test to confirm the
  observations from your visualization.

## Data analytics.
+ Aggregate the inspections by zip code to create
  a dataset with five columns. The first three columns are
  `zipcode`; `n_initial`, the
  count of the initial inspections in that zipcode; and 
  `n_initpass`, the number of initial inspections with a
  passing result in that zipcode. The other two variables
  are `n_compliance` and `n_comppass`, the counterpart
  for compliance inspections.

+ Add a variable to your dataset, `n_sighting`, which
  represent the number of rodent sightings from the 311
  service request data in the same 2022-2023 period.

+ Merge your dataset with the simple zipcode table in
  package `uszipcode` by zipcode to obtain demographic
  and socioeconomic variables at the zipcode level.

+ Build a binomial regression for the passing rate of initial
  inspections at the zipcode level. Assess the goodness-of-fit
  of your model. Summarize your results to a New Yorker
  who is not data science savvy.

##  Research Question

   Now you know the data quite well. Come up with a research
   question of interest that can be answered by the data, which
   could be analytics or visualizations. Perform the needed
   analyses and answer your question.